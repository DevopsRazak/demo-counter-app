pipeline {
       agent { node { label 'jdk11' } }

    stages {
        stage('Source code') {
            steps {
           git branch: 'main', url: 'https://github.com/DevopsRazak/demo-counter-app.git'   
            }
        }
        stage('build') {
            steps {
                sh 'mvn compile test package'
            }
        }
        stage('artifacts and test results') {
            steps {
            archiveArtifacts artifacts: 'target/*.jar', followSymlinks: false
            junit 'target/surefire-reports/*.xml'  
            }
        }
    }
    post {
        success {
                echo " Build Success"
                mail bcc: '', body: 'Build success', cc: 'razzaq307abdul@gmail.com', from: 'razzaq307abdul@gmail.com', replyTo: '', subject: 'Build Information', to: 'razzaq307abdul@gmail.com'
            }
            unsuccessful {
                 echo " Build Unsuccessfull"
                 mail bcc: '', body: 'Build success', cc: 'razzaq307abdul@gmail.com', from: 'razzaq307abdul@gmail.com', replyTo: '', subject: 'Build Information', to: 'razzaq307abdul@gmail.com'
            }
        }
    
}

